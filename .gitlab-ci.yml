image: dumux-precice:3.3git-iterative-pr-1.6.1
#image: dumux-precice:3.1-1.6.1

build:
  stage: build
  script:
    - cd ..
    - export DUNE_CONTROL_PATH=${PWD}/dumux-precice:${DUNE_CONTROL_PATH}
    - cd dumux-precice/
    - echo $DUNE_CONTROL_PATH
    - dunecontrol --only=dumux-precice --opts=/home/dumux/dumux/dumux/cmake.opts  all
    - cd build-cmake/appl/coupling-ff-pm/iterative-reversed/
    - make -j2 test_ff_reversed test_pm_reversed
  artifacts:
    expire_in: 3 days
    paths:
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/test_ff_reversed
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/test_pm_reversed
      - build-cmake/CMakeFiles/CMakeError.log
      - build-cmake/CMakeFiles/CMakeOutput.log
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/Makefile
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/CTestTestfile.cmake

test:
  stage: test
  script:
    - cd build-cmake/appl/coupling-ff-pm/iterative-reversed/
    - ctest
  artifacts:
    expire_in: 5 days
    paths:
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/Temporary/LastTest.log
      - build-cmake/appl/coupling-ff-pm/iterative-reversed/Temporary/LastTestsFailed.log
